<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="网络IP层, MAOSR">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>网络IP层 | MAOSR</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MAOSR</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">MAOSR</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/Maoshengren" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/Maoshengren" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">网络IP层</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E8%AE%A1%E7%BD%91/">
                                <span class="chip bg-color">计网</span>
                            </a>
                        
                            <a href="/tags/IP/">
                                <span class="chip bg-color">IP</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="post-category">
                                计算机网络
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-10-27
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-11-01
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    17 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="网络IP层"><a href="#网络IP层" class="headerlink" title="网络IP层"></a>网络IP层</h2><h3 id="1-数据层面"><a href="#1-数据层面" class="headerlink" title="1.数据层面"></a>1.数据层面</h3><h4 id="1-1-网络层概述"><a href="#1-1-网络层概述" class="headerlink" title="1.1 网络层概述"></a>1.1 网络层概述</h4><blockquote>
<p>网络层的作用从表面上看极为简单，即将分组从一台发送主机移动到一台接收主机。为此，需要使用两种重要的网络层功能: </p>
</blockquote>
<ul>
<li><strong>转发</strong>。当一个分组到达某路由器的一条输人链路时，该路由器必须将该分组移动到适当的输出链路。转发是在<strong>数据平面</strong>中实现的<strong>唯一功能</strong>。</li>
<li><strong>路由选择</strong>。当分组从发送方流向接收方时，网络层必须决定这些分组所采用的路由或路径。计算这些路径的算法被称为路由选择算法(routing algorithm)。<strong>路由选择</strong>在网络层的<strong>控制平面</strong>中实现。</li>
</ul>
<blockquote>
<p>更为精确的描述：</p>
<p><strong>转发</strong>是指将分组从一个输入链路接口转移到适当的输出链路接口的<strong>路由器本地</strong>操作。时间尺度短：ns级别</p>
<p><strong>路由选择</strong>是指确定分组从源目的地所采取的端到端路径的网络范围处理过程。时间尺度长：s级别</p>
</blockquote>
<ul>
<li>每台网络路由器中有一个关键元素是它的<strong>转发表(forwardingtable)</strong>。路由器检查到达分组首部字段值，使用这些值在其转发表中搜索，转发分组。</li>
<li>这些值对应存储在转发表项中的值，指出了该分组将被转发的路由器的<strong>输出链路接口</strong>。</li>
</ul>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027141029742.png" style="zoom: 40%;"></p>
<p><strong>控制平面</strong></p>
<blockquote>
<p>路由选择算法决定了插入该转发表的内容。路由选择算法运行在每台路由器中，并且每台路由器都有转发和路由选择两种功能。</p>
</blockquote>
<p><strong>网络服务模型</strong></p>
<blockquote>
<p>网络服务模型定义了分组在发送和接收端系统之间的端到端运输特性。</p>
</blockquote>
<ul>
<li><strong>确保交付：</strong>确保分组最终到达目的地</li>
<li><strong>具有时延上界的确保交付：</strong>在特定的主机到主机时延上界内（100ms内 e.g.）交付</li>
<li><strong>有序分组交付</strong>：确保分组以发送顺序到达目的地</li>
<li><strong>确保最小带宽：</strong>在双方之间模拟一条特定比特速率的传输链路，只要发送方传输速率低于该速率，所有分组确保交付到目的主机</li>
<li><strong>安全性：</strong>在发送方加密数据报，在接收方解密数据报。</li>
</ul>
<p>因特网的网络层提供了单一的服务，称为<strong>尽力而为服务</strong>( best- effort service)。使用尽力而为服务，传送的分组既不能保证以它们发送的顺序被接收，也不能保证它们最终交付;既不能保证端到端时延，也不能保证有最小的带宽。</p>
<hr>
<h4 id="1-2-路由器工作原理"><a href="#1-2-路由器工作原理" class="headerlink" title="1.2 路由器工作原理"></a>1.2 路由器工作原理</h4><blockquote>
<p>下图显示了路由器的总体视图。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027142710900.png" style="zoom:40%;"></p>
<ul>
<li><strong>输入端口</strong><ul>
<li>执行物理层功能，在路由器上终止传入的物理链路。</li>
<li>与位于输入链路远端的数据链路层交互来执行数据链路层功能。</li>
<li>在输入端口执行查找功能，通过转发表决定路由器的输出端口。</li>
</ul>
</li>
<li><strong>交换结构</strong><ul>
<li>交换结构将路由器的输入端口连接到它的输出端口。这种交换结构完全<br>包含在路由器之中，即是一个网络路由器中的网络。</li>
</ul>
</li>
<li><strong>输出端口</strong><ul>
<li>输出端口存储从交换结构接收的分组，并通过执行必要的链路层和物理层功能在输出链路上传输这些分组。</li>
<li>当一条链路是双向的时(即承载两个方向的流量)，输出端口通常与该链路的输入端口成对出现在同一线路卡上。</li>
</ul>
</li>
<li><strong>路由选择处理器</strong>：<ul>
<li>路由选择处理器执行控制平面功能。</li>
<li>在传统的路由器中，它执行路由选择协议，维护路由选择表与关联链路状态信息，并为该路由器计算转发表。</li>
<li>在SDN路由器中，路由选择处理器负责与远程控制器通信，接收由远程控制器计算的转发表项并安装在输入端口。</li>
</ul>
</li>
</ul>
<hr>
<p><strong>输入端口处理和基于目的地转发</strong></p>
<blockquote>
<p>路由器用分组目的地址的前缀(prefix)与该表中的表项进行匹配;如果存在一个匹配项，则路由器向与该匹配项相关联的链路转发分组。</p>
<p>当有多个匹配时，路由器使用最长前缀匹配规则，即在表中寻找最长的匹配项。</p>
</blockquote>
<ul>
<li>通过查找确定了某分组的输出端口，则该分组就能够发送进人交换结构。</li>
<li>如果来自其他输入端口的分组当前正在使用该交换结构，一个分组可能会在进入交换结构时被暂时阻塞。因此，一个被阻塞的分组必须要在输人端口处排队，并等待稍后被及时调度以通过交换结构。</li>
</ul>
<p>输入端口还需完成其他动作：</p>
<ol>
<li>必须出现物理层和链路层处理</li>
<li>必须检查分组的版本号、检验和以及寿命字段，并且重写后两个字段;</li>
<li>必须更新用于网络管理的计数器(如接收到的IP数据报的数目)。</li>
</ol>
<hr>
<p><strong>交换</strong></p>
<blockquote>
<p>交换结构位于一台路由器的核心部位，通过交换结构，分组能实际地从一个输入端口交换( 即转发)到一个输出端口中。交换可以用许多方式完成。</p>
</blockquote>
<ul>
<li><strong>经内存交换</strong>。在输入端口与输出端口之间的交换是在CPU (路由选择处理器)的直接控制下完成的。输入与输出端口的功能就像在传统操作系统中的I/O设备一样。<ul>
<li>分组到达输入端口时，通过中断被路由选择器复制进（<strong>读</strong>）内存。</li>
<li>从首部提取目的地址，在转发表中找出输出端口，将该分组复制到（<strong>写</strong>）输出端口的缓存。</li>
<li>如果内存带宽为每秒读写B个分组，则总的转发吞吐量(分组从输入端口被传送到输出端口的总速率，即一次<strong>读</strong>和一次<strong>写</strong>)必然小于B/2。</li>
</ul>
</li>
</ul>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027145001684.png" style="zoom:40%;"></p>
<ul>
<li><p><strong>经总线交换</strong>。输入端口经一根共享总线将分组直接传送到输出端口，不需要路由选择处理器的干预。</p>
<ul>
<li>输入端口为分组预先计划一个标签，指示输出端口，分组传送到所有输出端口，但只有与<strong>该标签匹配的端口</strong>才能保存该分组。</li>
<li>然后标签在输出端口被去除，因为其仅用于交换机内部来跨越总线。</li>
<li>如果多个不同输出端口分组同时到达路由器，一次只有一个分组能够跨越总线。</li>
<li>每个分组必须跨过单一总线，故路由器的交换带宽受总线速率的限制。</li>
</ul>
</li>
<li><p><strong>经互联网络交换</strong>。一种由2N条总线组成的互联网络，它连接N个输入端口与N个输出端口。每条垂直的总线与每条水平的总线交叉，交叉点通过交换结构控制器能开启和闭合。</p>
<ul>
<li>分组到达端口A，需要转发到端口Y时，交换机控制器闭合总线A和Y交叉部位的交叉点。</li>
<li>来自端口B的一个分组在同一时间能够转发到端口X，因为A到Y和B到X的分组使用不同的输入和输出总线。</li>
<li>纵横式交换机是非阻塞的(non-blocking)，即只要没有其他分组当前被转发到该输出端口，分组将不会被其他分组阻塞。如果目的地为相同的输出端口，则一个分组必须在输入端等待。</li>
</ul>
</li>
</ul>
<hr>
<p><strong>输出端口处理</strong></p>
<blockquote>
<p>输出端口处理取出已经存放在输出端口内存中的分组并将其发送到输出链路上。这包括选择和取出排队的分组进行传输，执行所需的链路层和物理层传输功能。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027150908497.png" style="zoom:50%;"></p>
<hr>
<p><strong>排队</strong></p>
<blockquote>
<p>排队的位置和程度(在输入端口或者在输出端口排队)将取决于流量负载、交换结构的相对速率和线路速率。因为随着这些队列的增长，路由器的缓存空间最终将会耗尽，并且当无内存可用于存储到达的分组时将会出现<strong>丢包</strong>(packet loss)。</p>
</blockquote>
<p><strong>1.输入排队</strong><br>如果交换结构不能快得使所有到达分组无时延地通过它传送，在输入端口将出现分组排队，到达的分组必须加入输入端口队列中，以等待通过交换结构传送到输出端口。</p>
<p>假定该交换结构决定发送左上角队列前端的分组。在这种情况下，左下角队列中的深色阴影分组必须等待。但不仅该分组要等待，左下角队列中排在该分组后面的浅色阴影分组也要等待，即使右中侧输出端口(浅色阴影分组的目的地)中无竞争。</p>
<p>这种现象叫作输入排队交换机中的<strong>线路前部(Head-Of-the-Line HOL)阻塞</strong></p>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027151943793.png" style="zoom:50%;"></p>
<p><strong>2.输出排队</strong></p>
<ul>
<li>在时刻t，每个输入端口都到达了一个分组，每个分组都是发往最上侧的输出端口。</li>
<li>假定线路速度相同，交换机以3倍于线路速度的速度运行，一个时间单位以后，所有三个初始分组都被传送到输出端口,并排队等待传输。</li>
<li>在下一个时间单位中，这三个分组中的一个将通过输出链路发送出去。</li>
<li>之后又有两个新分组已到达交换机的入端；这些分组之一要发往最上侧的输出端口。</li>
<li>输出端口的<strong>分组调度</strong>( packet scheduler) 在这些排队分组中选择一个分组来传输</li>
</ul>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027153011499.png" style="zoom:40%;"></p>
<hr>
<p><strong>分组调度</strong></p>
<p><strong>1.先进先出(FIFO)</strong></p>
<blockquote>
<p>FIFO(也称为先来先服务)调度规则按照分组到达输出链路队列的相同次序来选择分组在链路上传输。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027153557356.png" style="zoom:50%;"></p>
<p><strong>2.优先权排队</strong></p>
<blockquote>
<p>到达输出链路的分组被分类放入输出队列中的<strong>优先权类</strong>，如图所示。</p>
<p>在同一优先权类的分组之间通常以FIFO方式完成。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027153617049.png" style="zoom:50%;"></p>
<p><strong>3.循环和加权公平排队</strong></p>
<blockquote>
<p>在循环排队规则(round robin queuing discipline) 下，分组像使用优先权排队那样被分类。然而，在类之间不存在严格的服务优先权，循环调度器在这些类之间轮流提供服务。</p>
<p>一个所谓的保持工作排队(work-conserving queuing)规则在有分组排队等待传输时，不允许链路保持空闲。当类中没有分组时，将立即检查循环序列中的下一个类。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027153859087.png" style="zoom:50%;"></p>
<hr>
<h4 id="1-3-网际协议-IPV4、寻址、IPV6"><a href="#1-3-网际协议-IPV4、寻址、IPV6" class="headerlink" title="1.3 网际协议 IPV4、寻址、IPV6"></a>1.3 网际协议 IPV4、寻址、IPV6</h4><p><strong>IPV4数据报格式</strong></p>
<blockquote>
<p>网络层分组被称为<strong>数据报</strong>。</p>
<p>一个IP数据报有20 byte的首部（不包含选项），若数据报承载了一个TCP报文段（20 byte首部），则每个数据报共有40 byte的首部。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027154105483.png" style="zoom: 50%;"></p>
<hr>
<p><strong>IPV4数据报分片</strong></p>
<blockquote>
<p>不是所有链路层协议都能承载相同长度的网络层分组。以太网帧能够承载不超过1500字节的数据，而某些广域网链路的帧可承载不超过576字节的数据。</p>
<p>一个链路层帧能承载的最大数据量叫作<strong>最大传送单元</strong>(Maximum Transmission Unit, <strong>MTU</strong>) </p>
<p>因为每个IP数据报封装在链路层帧在路由器间传输，故链路层协议的MTU严格地限制着IP数据报的长度。</p>
</blockquote>
<ul>
<li><p><strong>片</strong>在其到达目的地运输层以前需要重新组装。为坚持网络内核保持简单的原则，IPv4的设计者决定将数据报的重新组装工作放到端系统中，而不是放到网络路由器中。</p>
</li>
<li><p>为了让目的主机执行这些重新组装任务，IPv4的设计者将<strong>标识</strong>、<strong>标志</strong>和<strong>片偏移</strong>字段放在IP数据报首部中。</p>
<ul>
<li>当生成一个数据报时，发送主机在为该数据报贴上<strong>标识号</strong>。发送主机通常将它发送的每个数据报的标识号+1。</li>
<li>当某路由器需要对一个数据报分片时，形成的每个数据报具有<strong>初始数据报标识号</strong>。</li>
<li>当从同一发送主机收到一系列数据报时，检查数据报的标识号以确定哪些数据报实际上是同一较大数据报的片。</li>
<li>为了让目的主机绝对地相信它已收到了初始数据报的最后一个片，最后一个片的<strong>标志</strong>比特被设为<strong>0</strong>，而所有其他片的<strong>标志</strong>比特被设为<strong>1</strong>。</li>
<li><strong>片偏移字段</strong>指定该片在初始IP数据报的位置。</li>
</ul>
</li>
</ul>
<hr>
<p><strong>IPV4编址</strong></p>
<blockquote>
<p>主机与物理链路之间的边界叫做<strong>接口</strong>。IP要求每台主机和路由器<strong>接口</strong>拥有自己的<strong>IP地址</strong>以发送和接收IP数据报。因此，从技术上讲，一个IP地址与一个接口相关联，而不是与包括该接口的主机或路由器相关联。</p>
<p>为便于书写，IPV4地址采用点分十进制记法，如<code>127.0.0.1</code>。</p>
<p><code>223.1.1.0/24</code> 其中 <code>/24</code> 称为<strong>子网掩码</strong>，表示最左侧24位定义了子网地址。</p>
<p><strong>子网</strong>：分开主机和路由器的接口，使用接口端接入这些隔离网络的端点，每个隔离网络都叫做子网。</p>
</blockquote>
<p>因特网地址分配策略：<strong>无类别域间路由选择（Classless Interdomain Routing CIDR）</strong>。</p>
<ul>
<li>使用子网寻址，IP地址分为两部分，<code>a.b.c.d/x</code>，<code>x</code> 指示了地址的第一部分bits，一般称为地址的<strong>前缀</strong>。</li>
<li>一个组织通常被分配一块连续的地址，即有相同前缀。</li>
</ul>
<blockquote>
<p><strong>广播地址</strong>：<code>255.255.255.255</code>。目的地为该地址的报文段会被转发给同一网络所有主机。</p>
</blockquote>
<hr>
<p><strong>DHCP</strong></p>
<blockquote>
<p>动态主机配置协议（Dynamic Host Configuration)，允许主机自动获取一个IP地址。同时获得子网掩码、第一跳路由器地址（默认网关）、本地DNS服务器地址等。</p>
</blockquote>
<ul>
<li>如下图，在本机使用<code>ipconfig</code>命令即可查看网络配置。</li>
</ul>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027193318662.png" style="zoom: 67%;"></p>
<p>对于一个新到达的主机，DHCP协议分为四步分配地址：</p>
<p><strong>1.DHCP服务器发现</strong></p>
<ul>
<li>通过使用DHCP发现报文实现。客户端在UDP分组中向端口67发送该报文。UDP分组封装在IP数据报中，使用广播目的地址<code>255.255.255.255</code>，将IP数据报传递给链路层，然后广播到子网连接的节点。</li>
</ul>
<p><strong>2.DHCP服务器提供</strong></p>
<ul>
<li>DHCP服务器收到DHCP发现报文，用<strong>DHCP提供报文</strong>响应客户端。仍用<code>255.255.255.255</code>向子网所有节点广播。</li>
<li>子网可能存在多个DHCP服务器，因此服务器报文中包含发现报文的<strong>事务ID</strong>、推荐给客户端的<strong>IP地址</strong>、<strong>网络掩码</strong>、IP地址<strong>租用期</strong>（IP地址有效时间，一般为几小时-几天）。</li>
</ul>
<p><strong>3.DHCP请求</strong></p>
<ul>
<li>客户端从一个或多个服务器提供中选择一个，并向选中的服务器提供<strong>DHCP请求报文</strong>，回显配置的参数。</li>
</ul>
<p><strong>4.DHCP ACK</strong></p>
<ul>
<li>服务器用<strong>DHCP ACK报文</strong>对DHCP请求进行响应，证实所求参数。</li>
</ul>
<p>客户端收到<strong>ACK</strong>后，交互完成。</p>
<hr>
<p><strong>网络地址转换</strong></p>
<blockquote>
<p>地址空间<code>10.0.0.0/8</code>是在[RFC 1918]中保留的三部分IP地址空间之一，这些地址用于下图等<strong>专用网络</strong>或具有专用地址的地域。</p>
<p><strong>具有专用地址的地域</strong>是指其地址仅对该网络中的设备有意义的网络。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027194912842.png" alt=""></p>
<ul>
<li><p>NAT使能路由器对于外部世界来说行为就如同具有单一IP地址的单一设备。</p>
<ul>
<li>上图所有离开家庭路由器流向更大因特网的报文都拥有一个源IP地址<code>138.76.29.7</code>,且所有进入家庭的报文都拥有同一个目的IP地址<code>138.76.29.7</code>。</li>
<li>NAT使能路由器对外界隐藏了家庭网络的细节。</li>
</ul>
</li>
<li><p>通过<strong>NAT转换表</strong>(NAT translation table)，路由器知道将分组转发给哪个内部主机。</p>
</li>
</ul>
<hr>
<p><strong>IPV6</strong></p>
<blockquote>
<p>IPV6数据报格式入下图。</p>
</blockquote>
<p><img src="/2021/10/27/wang-luo-ip-ceng/image-20211027195610223.png" alt=""></p>
<ul>
<li><strong>扩大的地址容量：</strong>128bits。</li>
<li><strong>40字节定长首部：</strong>允许路由器更快地处理数据。</li>
<li><strong>流标签：</strong>流（flow）。该字段用于“给属于特殊流（发送方要求特殊处理）的分组加上标签”。</li>
<li><strong>下一个首部(Next hdr)：</strong>标识数据报中内容需要交付给哪个协议（如TCP或UDP）。</li>
<li><strong>跳限制(Hop limit)：</strong>转发数据报的每台路由器将该字段-1。如果计数为0，则丢弃。</li>
</ul>
<hr>
<h3 id="2-控制平面"><a href="#2-控制平面" class="headerlink" title="2.控制平面"></a>2.控制平面</h3><h4 id="2-1路由选择算法"><a href="#2-1路由选择算法" class="headerlink" title="2.1路由选择算法"></a>2.1路由选择算法</h4><blockquote>
<p>从发送方到接受方确定一条通过路由器网络的最佳路径。</p>
</blockquote>
<ul>
<li><p>路由选择算法的一种分类方式：</p>
<ul>
<li><p><strong>集中式路由选择算法：</strong>用完整的、全局性的网络知识计算出从源地址到目的地址的最低开销路径。该算法以所有节点之间的<strong>连通性</strong>和所有链路的<strong>开销</strong>作为输入。</p>
<p>具有全局状态信息的算法通常称为<strong>链路状态(Link State, LS)算法</strong>。</p>
</li>
<li><p><strong>分散式路由选择算法：</strong>路由器以迭代、分布式的方式计算出最低开销路径。没有节点拥有关于所有网络链路开销的完整信息。每个节点仅有直接相连的链路开销信息即可工作。</p>
</li>
</ul>
</li>
<li><p>第二种分类方式：</p>
<ul>
<li><strong>静态路由选择算法：</strong>路由随时间变化非常缓慢，通常人工进行调整（人工编辑链路开销）。</li>
<li><strong>动态路由选择算法：</strong>随着网络流量负载或拓扑发生变化而改变路由选择路径。易受选择循环、路由震荡之类问题的影响。</li>
</ul>
</li>
<li><p>第三种分类方式：</p>
<ul>
<li><strong>负载敏感算法：</strong>链路开销会动态变化以反映底层链路的拥塞水平。</li>
<li><strong>负载迟钝算法：</strong>链路开销不反映拥塞水平</li>
</ul>
</li>
</ul>
<hr>
<p><strong>链路状态路由选择算法</strong></p>
<blockquote>
<p>通过每个节点向网络中所有其他节点广播链路状态分组（链路标识和开销）来确定所有链路开销。</p>
</blockquote>
<p><code>Disjkstra</code>算法</p>
<pre class="line-numbers language-pseudocode" data-language="pseudocode"><code class="language-pseudocode">Initialization:
	N’ = {u}
    for all nodes v
    if v is a neighbor of u
    	then D(v) = c(u, v)
    else 
    	D(v) = ∞

Loop
    find w not in N’ such that D(w) is a minimum
    add w to N’
    update D(v) for each neighbor v of w and not in N’:
    D(v) = min(D(v), D(w)+ c(w, v) )
    /* new cost to v is either old cost to v or known
       least path cost to w plus cost from w to v */
until N’= N<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<p><strong>距离向量路由选择算法</strong></p>
<blockquote>
<p>是一种迭代的、异步的、分布式的算法。</p>
<p><strong>分布式</strong>：每个节点从一个或多个直接相连邻居接收信息，执行计算，将结果分发给邻居。</p>
<p><strong>迭代</strong>：过程一直持续到邻居之间无更多信息交换为止。</p>
<p><strong>异步</strong>：不要求所有节点相互之间操作一致。</p>
</blockquote>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Maosr</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://Maoshengren.github.io/2021/10/27/wang-luo-ip-ceng/">http://Maoshengren.github.io/2021/10/27/wang-luo-ip-ceng/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Maosr</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E8%AE%A1%E7%BD%91/">
                                    <span class="chip bg-color">计网</span>
                                </a>
                            
                                <a href="/tags/IP/">
                                    <span class="chip bg-color">IP</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/10/28/xu-ni-cun-chu-qi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="虚拟存储器">
                        
                        <span class="card-title">虚拟存储器</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            virtual memory 知识点总结
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-10-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" class="post-category">
                                    计算机组成原理
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AE%A1%E7%BB%84/">
                        <span class="chip bg-color">计组</span>
                    </a>
                    
                    <a href="/tags/%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8/">
                        <span class="chip bg-color">虚拟存储</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/10/26/file-io/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="File I/O">
                        
                        <span class="card-title">File I/O</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            文件I/O总结
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-10-26
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/OS/" class="post-category">
                                    OS
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/IO/">
                        <span class="chip bg-color">IO</span>
                    </a>
                    
                    <a href="/tags/OS/">
                        <span class="chip bg-color">OS</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">Maosr</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">14.2k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Maoshengren" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1379338142@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1379338142" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1379338142" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
